---
layout:     post
title:      Objective-C中两种内存管理机制：ARC和MRC
category: blog
description: 在OC中对象是存储在堆中，所以系统并不会自动释放堆中的内存（基本类型是由系统自己管理的，放在栈上），如果一个对象创建使用后没有及时释放会占用大量内存，所以内存管理需要开发人员维护
---
Xcode4.1及其以前版本没有ARC（Auto Reference Counting），内存的管理是通过MRC（Mannul Reference Counting）。

在MRC的内存管理模式下，对变量的管理相关方法有：retain，release和autorelease。retain和release方法操作的引用计数，当引用计数为0时，边自动释放内存。并且可以用NSAutoreleasePool对象，对加入自动释放池（autorelease调用）的变量进行管理，当drain时回收内存。

* `retain`该方法的作用是将内存数据的所有权附给另一个指针变量，引用数加1，即retainCount+=1；
* `release`该方法是你释放指针变量对内存数据的所有权，引用数减1，即retainCount-=1；
* `autorelease`该方法是将该对象内存的管理放到autoreleasepool中。

在ARC中与内存管理有关的标识符，可以分为变量标识符，对于变量默认为__strong，而对于属性为unsafe_unretained。也存在autoreleasepool。
其中assign/retain/copy与MRC下property的标识符意义相同，strong类似与retain，assign类似于unsafe_unretained，strong/weak/unsafe_unretained与ARC下标识符意义相同，只是一个用于属性的标识，一个用于变量的标识（带两个下划线__）。所列出的其他标识符与MRC下意义相同。